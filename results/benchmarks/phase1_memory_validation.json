{
  "baseline": {
    "model_name": "Baseline (ResNet-BK)",
    "config": {
      "vocab_size": 50257,
      "d_model": 1024,
      "n_layers": 6,
      "n_seq": 512,
      "num_experts": 4,
      "top_k": 1,
      "dropout_p": 0.1
    },
    "batch_size": 1,
    "seq_length": 512,
    "vocab_size": 50257,
    "d_model": 1024,
    "n_layers": 6,
    "snapshots": [
      {
        "stage": "initial",
        "allocated_mb": 779.39794921875,
        "reserved_mb": 878.0,
        "max_allocated_mb": 779.39794921875,
        "timestamp_ms": 0.0
      },
      {
        "stage": "before_forward",
        "allocated_mb": 779.40576171875,
        "reserved_mb": 878.0,
        "max_allocated_mb": 779.40576171875,
        "timestamp_ms": 27.000904083251953
      },
      {
        "stage": "after_forward",
        "allocated_mb": 1109.08203125,
        "reserved_mb": 1156.0,
        "max_allocated_mb": 1109.08203125,
        "timestamp_ms": 1123.5911846160889
      },
      {
        "stage": "before_backward",
        "allocated_mb": 1109.08203125,
        "reserved_mb": 1154.0,
        "max_allocated_mb": 1109.08203125,
        "timestamp_ms": 1124.4840621948242
      },
      {
        "stage": "after_backward",
        "allocated_mb": 1673.20947265625,
        "reserved_mb": 1872.0,
        "max_allocated_mb": 1675.2099609375,
        "timestamp_ms": 1409.1272354125977
      },
      {
        "stage": "final",
        "allocated_mb": 1673.20947265625,
        "reserved_mb": 1872.0,
        "max_allocated_mb": 1675.2099609375,
        "timestamp_ms": 1410.2122783660889
      },
      {
        "stage": "before_full_pass",
        "allocated_mb": 1673.20947265625,
        "reserved_mb": 1848.0,
        "max_allocated_mb": 1673.20947265625,
        "timestamp_ms": 1418.7226295471191
      },
      {
        "stage": "after_full_pass",
        "allocated_mb": 1673.20947265625,
        "reserved_mb": 2372.0,
        "max_allocated_mb": 2093.2021484375,
        "timestamp_ms": 2192.1231746673584
      }
    ],
    "peak_forward_mb": 1109.08203125,
    "peak_backward_mb": 1675.2099609375,
    "peak_total_mb": 2093.2021484375,
    "baseline_peak_mb": null,
    "memory_reduction_percent": null,
    "passes_8gb_target": true,
    "passes_10gb_target": true
  },
  "phase1": {
    "model_name": "Phase 1 (AR-SSM + HTT)",
    "config": {
      "vocab_size": 50257,
      "d_model": 1024,
      "n_layers": 6,
      "n_seq": 512,
      "phase1_config": {
        "ar_ssm_enabled": true,
        "ar_ssm_max_rank": 32,
        "ar_ssm_min_rank": 4,
        "ar_ssm_gate_hidden_dim": null,
        "ar_ssm_l1_regularization": 0.001,
        "ar_ssm_use_fused_scan": true,
        "htt_enabled": true,
        "htt_rank": 16,
        "htt_num_cores": 2,
        "htt_phase_encoding": true,
        "htt_compression_target": 0.1,
        "lns_enabled": false,
        "lns_block_size_m": 128,
        "lns_block_size_n": 128,
        "lns_block_size_k": 32,
        "lns_use_max_log": true,
        "stability_monitoring_enabled": true,
        "stability_threshold": 1e-06,
        "schatten_s1_bound": 100.0,
        "schatten_s2_bound": 50.0,
        "gradient_norm_threshold": 10.0,
        "use_gradient_checkpointing": true,
        "checkpoint_ar_ssm": true,
        "checkpoint_htt": false,
        "target_vram_gb": 8.0,
        "target_ppl_degradation": 0.05,
        "target_speedup": 3.0
      }
    },
    "batch_size": 1,
    "seq_length": 512,
    "vocab_size": 50257,
    "d_model": 1024,
    "n_layers": 6,
    "snapshots": [
      {
        "stage": "initial",
        "allocated_mb": 598.29931640625,
        "reserved_mb": 700.0,
        "max_allocated_mb": 598.29931640625,
        "timestamp_ms": 0.0
      },
      {
        "stage": "before_forward",
        "allocated_mb": 598.30712890625,
        "reserved_mb": 700.0,
        "max_allocated_mb": 598.30712890625,
        "timestamp_ms": 0.9889602661132812
      },
      {
        "stage": "after_forward",
        "allocated_mb": 927.51611328125,
        "reserved_mb": 962.0,
        "max_allocated_mb": 927.51611328125,
        "timestamp_ms": 645.9894180297852
      },
      {
        "stage": "before_backward",
        "allocated_mb": 927.51611328125,
        "reserved_mb": 960.0,
        "max_allocated_mb": 927.51611328125,
        "timestamp_ms": 654.9887657165527
      },
      {
        "stage": "after_backward",
        "allocated_mb": 1278.51220703125,
        "reserved_mb": 1480.0,
        "max_allocated_mb": 1295.55908203125,
        "timestamp_ms": 707.7553272247314
      },
      {
        "stage": "final",
        "allocated_mb": 1278.51220703125,
        "reserved_mb": 1480.0,
        "max_allocated_mb": 1295.55908203125,
        "timestamp_ms": 707.7553272247314
      },
      {
        "stage": "before_full_pass",
        "allocated_mb": 1278.51220703125,
        "reserved_mb": 1444.0,
        "max_allocated_mb": 1278.51220703125,
        "timestamp_ms": 711.26389503479
      },
      {
        "stage": "after_full_pass",
        "allocated_mb": 1278.51220703125,
        "reserved_mb": 1980.0,
        "max_allocated_mb": 1707.18408203125,
        "timestamp_ms": 1532.019853591919
      }
    ],
    "peak_forward_mb": 927.51611328125,
    "peak_backward_mb": 1295.55908203125,
    "peak_total_mb": 1707.18408203125,
    "baseline_peak_mb": 2093.2021484375,
    "memory_reduction_percent": 18.441509182206726,
    "passes_8gb_target": true,
    "passes_10gb_target": true
  }
}