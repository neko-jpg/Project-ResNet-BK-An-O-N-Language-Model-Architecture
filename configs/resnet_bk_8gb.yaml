# ResNet-BK 8GB VRAM対応設定
# BK-Coreを使ったO(N)言語モデル
# 物理ベースのアーキテクチャで高効率訓練

model:
  d_model: 512
  n_layers: 12
  n_seq: 512
  vocab_size: 50257
  
  # MoE設定
  num_experts: 4
  top_k: 2
  dropout_p: 0.1
  
  # BK-Core設定
  use_birman_schwinger: true  # Birman-Schwinger核を使用
  epsilon: 1.0
  use_mourre: true
  use_lap: true
  
  # Hybrid Attention（オプション）
  use_hybrid_attention: false  # メモリ節約のため無効
  hyperbolic_window_size: 64
  num_heads: 8
  
  # Tritonカーネル
  use_triton_kernel: false  # 安定性のため無効
  use_fused_moe_kernel: false

training:
  batch_size: 4
  gradient_accumulation_steps: 8  # Effective batch size: 32
  epochs: 10
  learning_rate: 3.0e-4
  warmup_steps: 1000
  weight_decay: 0.01
  max_grad_norm: 1.0
  
  # Mixed Precision
  mixed_precision: true
  fp16: true
  
  # Gradient Checkpointing
  gradient_checkpointing: false  # 安定性のため無効

optimization:
  empty_cache_every: 10

checkpoint:
  save_dir: checkpoints/resnet_bk_8gb
  save_every: 1000
  keep_last_n: 3

logging:
  log_every: 50
  eval_every: 500
  wandb: false

# Expected Performance
# Model Parameters: ~50-100M
# Memory Usage: ~2-3 GB (8GB以内に余裕で収まる)
# Complexity: O(N) thanks to BK-Core
